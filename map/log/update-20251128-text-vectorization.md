# Векторизация центрированного текста | 2025-11-28

## Проблема
Центральный текст при экспорте заменялся на Arial или Roboto, в то время как круговой текст корректно сохранял шрифты как векторные пути.

## Причина
- Круговой текст (TextElement) использовал `useCurvedTextVectorization` для преобразования в пути
- Центрированный текст (TextCenteredElement) оставался как SVG `<text>` элемент с указанием шрифта
- При экспорте, если шрифт недоступен в системе, он заменялся fallback шрифтом

## Решение
1. Создан новый хук: `src/hooks/useCenteredTextVectorization.ts` для векторизации прямого текста
2. Обновлён `TextCenteredElement.tsx` для использования векторизации
3. Обновлён `TextElement.tsx` для векторизации прямого текста (в дополнение к кривому)
4. Теперь ВСЕ текстовые элементы преобразуются в векторные пути перед экспортом

## Изменённые файлы

### 1. `src/hooks/useCenteredTextVectorization.ts` - **СОЗДАН**
- Создан хук для векторизации центрированного текста
- Использует `convertTextToPath` для преобразования текста в SVG пути
- Включает кэширование для производительности
- Аналогичен `useCurvedTextVectorization` но для прямого текста

### 2. `src/components/Canvas/elements/TextCenteredElement.tsx` - **ОБНОВЛЁН**
- Добавлен импорт `useCenteredTextVectorization`
- Теперь использует векторизованные пути при экспорте
- Проверяет флаг `loading` для отображения заглушки при загрузке
- Возвращает SVG `<g>` элемент с векторизованными путями

### 3. `src/components/Canvas/elements/TextElement.tsx` - **ОБНОВЛЁН**
- Теперь использует два подхода:
  - Для кривого текста: `useCurvedTextVectorization`
  - Для прямого текста: `useCenteredTextVectorization`
- Обеспечивает векторизацию всех текстов

## Результат

### Что исправлено
✅ Центрированный текст теперь векторизуется и сохраняет шрифт при экспорте
✅ Прямой текст в TextElement также векторизуется
✅ Все текстовые элементы сохраняют шрифты в PNG/SVG/PDF экспорте
✅ Совместимость с CorelDRAW, Inkscape и другими векторными редакторами

### Технические детали
- Использует ту же систему кэширования что и `useCurvedTextVectorization`
- Сохраняет все параметры текста: размер, цвет, жирность, курсив
- Поддерживает кэширование для предотвращения лишних перерисовок

## Тестирование

Для проверки:
1. Создать центрированный текст с любым шрифтом из Google Fonts
2. Экспортировать в SVG/PNG/PDF
3. Проверить, что шрифт сохранился (шрифт должен быть векторным путём, а не текстом)
4. Проверить в векторном редакторе (CorelDRAW, Inkscape) - должен отображаться корректно

## Архитектурные изменения

Теперь все текстовые элементы:
- Круговой текст → векторизуется через `useCurvedTextVectorization`
- Центрированный текст → векторизуется через `useCenteredTextVectorization`
- Прямой текст → векторизуется через `useCenteredTextVectorization`

## Результаты для пользователей

- Раньше: центрированный текст при экспорте заменялся на Arial/Roboto
- Теперь: центрированный текст сохраняется с правильным шрифтом как векторные пути
- Все 90 Google Fonts с кириллицей корректно отображаются в экспортируемых файлах